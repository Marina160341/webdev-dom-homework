<!DOCTYPE html>
<html>
  <head>
    <title>Проект "Комменты"</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="container">
      <ul class="comments" id="commentContainer"></ul>
      <div class="add-form">
        <input
          type="text" id="nameUser"
          class="add-form-name"
          placeholder="Введите ваше имя"
        />
        <textarea
          type="textarea"
          class="add-form-text" id="textUser"
          placeholder="Введите ваш коментарий"
          rows="4"
        ></textarea>
        <div class="add-form-row">
          <button class="add-form-button" id="buttonAdd">Написать</button>
        </div>
      </div>
    </div>
  </body>
<style>
  .error{
    background-color: red;
  }
  .no-click {pointer-events: none;
  background-color: aliceblue;}
</style>
<script>
  "use strict";
  const buttonElement = document.getElementById('buttonAdd');
  const commentContainerElement=document.getElementById('commentContainer');
  const commentlistElement=document.getElementById('commentList');
  const nameUserElement=document.getElementById('nameUser');
  const textUserElement=document.getElementById('textUser');
  const likesLink=document.querySelectorAll('.likes-counter');
  const commentText=document.getElementById('comment');
  let Data=new Date();
  const comments=[
    {
    name: "Глеб Фокин",
    data: "08.08.2023 18:55",
    comment:"Это будет первый комментарий к этой странице",
    like: 3,
    isliked: false,
    },
    {
     name: "Марина Кемова",
     data: "08.08.2023 18:55",
     comment:"Это будет первый комментарий к этой странице",
     like: 3,
     isliked: false,
    },
    ] 
  Data=Data.toLocaleString();
  const initEventListeners = ()=>{
  const likesButton=document.querySelectorAll(".like-button");
    for (const likeButton of likesButton ){
    likeButton.addEventListener("click", ()=>{
    const index = likeButton.dataset.index;
      if(comments[index].isliked){
         comments[index].isliked=false;
         comments[index].like--;
      }else{
         comments[index].like++;
         comments[index].isliked=true;
          };
  renderComments();
        });
        };
      };
  const renderComments=()=>{
  const commentHTML=comments.map((comment, index)=>{
  return `<li class="comment">
          <div class="comment-header">
            <div>${comment.name}</div>
            <div>${comment.data}</div>
          </div>
          <div class="comment-body">
            <div class="comments">
              ${comment.comment}
          </div>
          </div>
          <div class="comment-footer">
            <div class="likes";
              <span class="likes-counter">${comment.like}</span>
              <button  id="like-button" class="like-button ${comments.isliked ? '-active-like': ''}" data-index="${index}"></button>
            </div>
          </div>
        </li>`;
      }).join('');
      commentContainerElement.innerHTML=commentHTML;
      initEventListeners();
      };
  renderComments();
  buttonElement.addEventListener("click", () => {
  nameUserElement.classList.remove('error');
  buttonElement.classList.remove('no-click')
      if (nameUserElement.value ==='') {
      nameUserElement.classList.add('error')
      return;
    }
      if (textUserElement.value === "") {
        textUserElement.classList.add('error');
        return
      }
      comments.push({
        name: nameUserElement.value,
        data: Data,
        comment:textUserElement.value,
        like: 0,
        islike:false
    });
  renderComments();
      });
    </script>
</html>
